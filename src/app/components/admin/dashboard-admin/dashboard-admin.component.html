<div class="dashboard-admin">
  <!-- En-tête du dashboard -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1>Tableau de Bord Administrateur</h1>
      <p>Bienvenue, {{ currentUser?.prenom }} {{ currentUser?.nom }}</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" routerLink="/admin/clients/new">
        <i class="fas fa-plus"></i>
        Nouveau Client
      </button>
      <div class="date-display">
        <i class="fas fa-calendar"></i>
        {{ currentDate | date:'fullDate' }}
      </div>
    </div>
  </div>

  <!-- Indicateur de chargement -->
  <div class="loading-state" *ngIf="isLoading">
    <i class="fas fa-spinner fa-spin"></i>
    <p>Chargement du tableau de bord...</p>
  </div>

  <!-- Contenu principal -->
  <div *ngIf="!isLoading">
    <!-- Cartes de statistiques -->
    <div class="stats-grid">
      <!-- Carte Propriétaires -->
      <div class="stat-card">
        <div class="stat-icon proprietaires">
          <i class="fas fa-user-tie"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.proprietaires.total }}</h3>
          <p>Propriétaires</p>
          <span class="stat-trend" [class.positive]="stats.proprietaires.evolution >= 0"
            [class.negative]="stats.proprietaires.evolution < 0">
            <i class="fas" [class.fa-arrow-up]="stats.proprietaires.evolution >= 0"
              [class.fa-arrow-down]="stats.proprietaires.evolution < 0"></i>
            {{ stats.proprietaires.evolution }}% ce mois
          </span>
        </div>
      </div>

      <!-- Carte Locataires -->
      <div class="stat-card">
        <div class="stat-icon locataires">
          <i class="fas fa-user"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.locataires.total }}</h3>
          <p>Locataires</p>
          <span class="stat-trend" [class.positive]="stats.locataires.evolution >= 0"
            [class.negative]="stats.locataires.evolution < 0">
            <i class="fas" [class.fa-arrow-up]="stats.locataires.evolution >= 0"
              [class.fa-arrow-down]="stats.locataires.evolution < 0"></i>
            {{ stats.locataires.evolution }}% ce mois
          </span>
        </div>
      </div>

      <!-- Carte Agents -->
      <div class="stat-card">
        <div class="stat-icon agents">
          <i class="fas fa-briefcase"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.agents.total }}</h3>
          <p>Agents</p>
          <span class="stat-trend" [class.positive]="stats.agents.evolution >= 0"
            [class.negative]="stats.agents.evolution < 0">
            <i class="fas" [class.fa-arrow-up]="stats.agents.evolution >= 0"
              [class.fa-arrow-down]="stats.agents.evolution < 0"></i>
            {{ stats.agents.evolution }}% ce mois
          </span>
        </div>
      </div>

      <!-- Carte Biens Immobiliers -->
      <div class="stat-card">
        <div class="stat-icon properties">
          <i class="fas fa-building"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.biens.total }}</h3>
          <p>Biens Gérés</p>
          <div class="stat-details">
            <small>{{ stats.biens.disponibles }} disponibles</small>
            <small>{{ stats.biens.loues }} loués</small>
          </div>
          <span class="stat-trend" [class.positive]="stats.biens.evolution >= 0"
            [class.negative]="stats.biens.evolution < 0">
            <i class="fas" [class.fa-arrow-up]="stats.biens.evolution >= 0"
              [class.fa-arrow-down]="stats.biens.evolution < 0"></i>
            {{ stats.biens.evolution }}% ce mois
          </span>
        </div>
      </div>

      <!-- Carte Revenus -->
      <div class="stat-card">
        <div class="stat-icon revenue">
          <i class="fas fa-euro-sign"></i>
        </div>
        <div class="stat-content">
          <h3>{{ formatCurrency(stats.revenus.mensuel) }}</h3>
          <p>Revenus Mensuels</p>
          <span class="stat-trend" [class.positive]="stats.revenus.evolution >= 0"
            [class.negative]="stats.revenus.evolution < 0">
            <i class="fas" [class.fa-arrow-up]="stats.revenus.evolution >= 0"
              [class.fa-arrow-down]="stats.revenus.evolution < 0"></i>
            {{ stats.revenus.evolution }}% ce mois
          </span>
        </div>
      </div>

      <!-- Carte Contrats en Attente -->
      <div class="stat-card">
        <div class="stat-icon pending">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.contrats.enAttente }}</h3>
          <p>Contrats en Attente</p>
          <span class="stat-trend" [class.positive]="stats.contrats.evolution >= 0"
            [class.negative]="stats.contrats.evolution < 0">
            <i class="fas" [class.fa-arrow-up]="stats.contrats.evolution >= 0"
              [class.fa-arrow-down]="stats.contrats.evolution < 0"></i>
            {{ stats.contrats.evolution }}% ce mois
          </span>
        </div>
      </div>
    </div>

    <!-- Grille principale -->
    <div class="dashboard-grid">
      <!-- Section gauche -->
      <div class="grid-left">
        <!-- Graphique d'activité (placeholder) -->
        <div class="chart-card">
          <div class="card-header">
            <h3>Activité Récente</h3>
            <select class="period-select">
              <option>7 derniers jours</option>
              <option>30 derniers jours</option>
              <option>3 derniers mois</option>
            </select>
          </div>
          <div class="chart-placeholder">
            <i class="fas fa-chart-line"></i>
            <p>Graphique d'activité des clients</p>
          </div>
        </div>

        <!-- Derniers clients -->
        <div class="recent-clients">
          <div class="card-header">
            <h3>Clients Récents</h3>
            <a routerLink="/admin/clients" class="view-all">Voir tout</a>
          </div>
          <div class="clients-list">
            <div class="client-item" *ngFor="let client of recentClients">
              <div class="client-avatar">
                {{ client.prenom.charAt(0) }}{{ client.nom.charAt(0) }}
              </div>
              <div class="client-info">
                <h4>{{ client.prenom }} {{ client.nom }}</h4>
                <p>{{ client.email }}</p>
                <small>Inscrit le {{ formatDate(client.dateInscription) }}</small>
              </div>
              <div class="client-type">
                <span [class]="getClientTypeClass(client.type)">{{ getClientTypeLabel(client.type) }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Section droite -->
      <div class="grid-right">
        <!-- Actions rapides -->
        <div class="quick-actions">
          <h3>Actions Rapides</h3>
          <div class="actions-grid">
            <button class="action-btn" routerLink="/admin/clients/new">
              <i class="fas fa-user-plus"></i>
              Ajouter Client
            </button>
            <button class="action-btn" routerLink="/admin/agents/new">
              <i class="fas fa-briefcase"></i>
              Ajouter Agent
            </button>
            <button class="action-btn" routerLink="/admin/biens/new">
              <i class="fas fa-home"></i>
              Ajouter Bien
            </button>
            <button class="action-btn">
              <i class="fas fa-file-contract"></i>
              Nouveau Contrat
            </button>
            <button class="action-btn">
              <i class="fas fa-chart-bar"></i>
              Générer Rapport
            </button>
            <button class="action-btn">
              <i class="fas fa-cog"></i>
              Paramètres
            </button>
          </div>
        </div>

        <!-- Alertes et notifications -->
        <div class="alerts-card">
          <div class="card-header">
            <h3>Alertes Récentes</h3>
            <span class="badge">3</span>
          </div>
          <div class="alerts-list">
            <div class="alert-item warning">
              <i class="fas fa-exclamation-triangle"></i>
              <div class="alert-content">
                <p>3 paiements en retard</p>
                <small>Il y a 2 heures</small>
              </div>
            </div>
            <div class="alert-item info">
              <i class="fas fa-info-circle"></i>
              <div class="alert-content">
                <p>Nouvelle demande de visite</p>
                <small>Il y a 5 heures</small>
              </div>
            </div>
            <div class="alert-item success">
              <i class="fas fa-check-circle"></i>
              <div class="alert-content">
                <p>Contrat signé - Dupont Martin</p>
                <small>Hier</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Statistiques rapides -->
        <div class="quick-stats">
          <h3>Statistiques Rapides</h3>
          <div class="stats-list">
            <div class="stat-item">
              <span class="stat-label">Taux d'occupation</span>
              <span class="stat-value">92%</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Clients actifs</span>
              <span class="stat-value">89%</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Satisfaction</span>
              <span class="stat-value">4.5/5</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
